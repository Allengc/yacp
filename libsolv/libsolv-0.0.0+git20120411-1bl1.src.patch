--- origsrc/libsolv/ext/CMakeLists.txt	2012-04-12 18:57:09.000000000 +0900
+++ src/libsolv/ext/CMakeLists.txt	2012-04-12 19:19:28.247414300 +0900
@@ -73,11 +73,13 @@ ELSE (DISABLE_SHARED)
 ADD_LIBRARY (libsolvext SHARED ${libsolvext_SRCS})
 ENDIF (DISABLE_SHARED)
 
+TARGET_LINK_LIBRARIES(libsolvext libsolv lzma z)
+
 SET_TARGET_PROPERTIES(libsolvext PROPERTIES OUTPUT_NAME "solvext")
 SET_TARGET_PROPERTIES(libsolvext PROPERTIES SOVERSION ${LIBSOLVEXT_SOVERSION})
 
 INSTALL (FILES ${libsolvext_HEADERS} DESTINATION "${CMAKE_INSTALL_PREFIX}/include/solv")
-INSTALL (TARGETS libsolvext LIBRARY DESTINATION ${LIB_INSTALL_DIR} ARCHIVE DESTINATION ${LIB_INSTALL_DIR})
+INSTALL (TARGETS libsolvext RUNTIME DESTINATION ${BIN_INSTALL_DIR} ARCHIVE DESTINATION ${LIB_INSTALL_DIR})
 
 IF (ENABLE_STATIC AND NOT DISABLE_SHARED)
 ADD_LIBRARY (libsolvext_static STATIC ${libsolvext_SRCS})
--- origsrc/libsolv/src/CMakeLists.txt	2012-04-12 18:57:09.000000000 +0900
+++ src/libsolv/src/CMakeLists.txt	2012-04-12 19:18:58.091164300 +0900
@@ -40,7 +40,7 @@ SET_TARGET_PROPERTIES(libsolv PROPERTIES
 SET_TARGET_PROPERTIES(libsolv PROPERTIES SOVERSION ${LIBSOLV_SOVERSION})
 
 INSTALL (FILES ${libsolv_HEADERS} DESTINATION "${CMAKE_INSTALL_PREFIX}/include/solv")
-INSTALL (TARGETS libsolv LIBRARY DESTINATION ${LIB_INSTALL_DIR} ARCHIVE DESTINATION ${LIB_INSTALL_DIR})
+INSTALL (TARGETS libsolv RUNTIME DESTINATION ${BIN_INSTALL_DIR} ARCHIVE DESTINATION ${LIB_INSTALL_DIR})
 
 IF (ENABLE_STATIC AND NOT DISABLE_SHARED)
 ADD_LIBRARY (libsolv_static STATIC ${libsolv_SRCS})
--- origsrc/libsolv/src/util.c	2012-04-12 18:57:09.000000000 +0900
+++ src/libsolv/src/util.c	2012-04-12 19:07:06.497414300 +0900
@@ -115,7 +115,7 @@ solv_timems(unsigned int subtract)
 
    see also: http://sources.redhat.com/ml/libc-alpha/2008-12/msg00003.html
  */
-#if defined(__GLIBC__)
+#if defined(__GLIBC__) || defined(__CYGWIN__)
 
 # if HAVE_QSORT_R || HAVE___QSORT_R
 void
