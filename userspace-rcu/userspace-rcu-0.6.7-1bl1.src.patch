--- origsrc/userspace-rcu-0.6.7/Makefile.am	2011-12-13 08:24:31.000000000 +0900
+++ src/userspace-rcu-0.6.7/Makefile.am	2012-02-05 18:26:48.346445400 +0900
@@ -2,7 +2,7 @@ INCLUDES = -I$(top_builddir)/urcu
 
 #Add the -version-info directly here since we are only building
 # library that use the version-info
-AM_LDFLAGS=-lpthread -version-info $(URCU_LIBRARY_VERSION)
+AM_LDFLAGS=-lpthread -version-info $(URCU_LIBRARY_VERSION) -no-undefined
 AM_CFLAGS=-Wall
 
 SUBDIRS = . tests
@@ -13,7 +13,12 @@ nobase_dist_include_HEADERS = urcu/compi
 		urcu/rculist.h urcu/rcuhlist.h urcu/system.h urcu/futex.h \
 		urcu/uatomic/generic.h urcu/arch/generic.h urcu/wfstack.h \
 		urcu/wfqueue.h urcu/rculfstack.h urcu/rculfqueue.h \
-		urcu/ref.h urcu/map/*.h urcu/static/*.h urcu/cds.h \
+		urcu/ref.h urcu/map/urcu-bp.h urcu/map/urcu-qsbr.h \
+		urcu/map/urcu.h urcu/static/rculfqueue.h \
+		urcu/static/rculfstack.h urcu/static/urcu-bp.h \
+		urcu/static/urcu-pointer.h urcu/static/urcu-qsbr.h \
+		urcu/static/urcu.h urcu/static/wfqueue.h \
+		urcu/static/wfstack.h urcu/cds.h \
 		urcu/urcu_ref.h urcu/urcu-futex.h urcu/uatomic_arch.h
 nobase_nodist_include_HEADERS = urcu/arch.h urcu/uatomic.h urcu/config.h
 
