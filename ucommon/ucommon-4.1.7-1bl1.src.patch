--- origsrc/ucommon-4.1.7/common/Makefile.am	2011-02-01 21:30:04.000000000 +0900
+++ src/ucommon-4.1.7/common/Makefile.am	2011-03-17 21:16:37.857574400 +0900
@@ -14,7 +14,7 @@ AM_CXXFLAGS = -I$(top_srcdir)/inc $(UCOM
 
 lib_LTLIBRARIES = libucommon.la 
 
-libucommon_la_LDFLAGS = @UCOMMON_LIBS@ @UCOMMON_CLINK@ $(RELEASE) 
+libucommon_la_LDFLAGS = @UCOMMON_LIBS@ @UCOMMON_CLINK@ $(RELEASE) -no-undefined
 libucommon_la_SOURCES = object.cpp linked.cpp string.cpp mapped.cpp \
 	counter.cpp bitmap.cpp timer.cpp memory.cpp socket.cpp access.cpp \
 	thread.cpp fsys.cpp cpr.cpp vector.cpp xml.cpp stream.cpp persist.cpp \
--- origsrc/ucommon-4.1.7/configure.ac	2011-03-05 21:51:53.000000000 +0900
+++ src/ucommon-4.1.7/configure.ac	2011-03-17 21:16:37.867588800 +0900
@@ -20,8 +20,7 @@ AC_PROG_CPP
 AC_PROG_CC
 AC_PROG_CXXCPP
 AC_PROG_CXX
-AC_LIBTOOL_WIN32_DLL
-AM_PROG_LIBTOOL
+LT_INIT(win32-dll)
 AM_INIT_AUTOMAKE(ucommon, [$VERSION])
 AM_CONFIG_HEADER(config.h)
 
--- origsrc/ucommon-4.1.7/gnutls/Makefile.am	2010-11-02 02:48:09.000000000 +0900
+++ src/ucommon-4.1.7/gnutls/Makefile.am	2011-03-17 21:16:37.877603200 +0900
@@ -16,7 +16,7 @@ noinst_HEADERS = local.h
 
 lib_LTLIBRARIES = libusecure.la
 
-libusecure_la_LDFLAGS = ../common/libucommon.la @UCOMMON_LIBS@ @SECURE_LIBS@ @UCOMMON_CLINK@ $(RELEASE)
+libusecure_la_LDFLAGS = ../common/libucommon.la @UCOMMON_LIBS@ @SECURE_LIBS@ @UCOMMON_CLINK@ $(RELEASE) -no-undefined
 libusecure_la_SOURCES = secure.cpp ssl.cpp digest.cpp random.cpp cipher.cpp \
 	sstream.cpp
 
--- origsrc/ucommon-4.1.7/nossl/Makefile.am	2010-11-02 02:49:03.000000000 +0900
+++ src/ucommon-4.1.7/nossl/Makefile.am	2011-03-17 21:16:37.877603200 +0900
@@ -15,7 +15,7 @@ AM_CXXFLAGS = -I$(top_srcdir)/inc @UCOMM
 noinst_HEADERS = local.h
 lib_LTLIBRARIES = libusecure.la
 
-libusecure_la_LDFLAGS = ../common/libucommon.la @SECURE_LIBS@ @UCOMMON_LIBS@ @UCOMMON_CLINK@ $(RELEASE)
+libusecure_la_LDFLAGS = ../common/libucommon.la @SECURE_LIBS@ @UCOMMON_LIBS@ @UCOMMON_CLINK@ $(RELEASE) -no-undefined
 libusecure_la_SOURCES = secure.cpp ssl.cpp digest.cpp random.cpp cipher.cpp \
 	sstream.cpp
 
--- origsrc/ucommon-4.1.7/openssl/Makefile.am	2010-11-02 02:50:28.000000000 +0900
+++ src/ucommon-4.1.7/openssl/Makefile.am	2011-03-17 21:16:37.887617600 +0900
@@ -16,7 +16,7 @@ noinst_HEADERS = local.h
 
 lib_LTLIBRARIES = libusecure.la
 
-libusecure_la_LDFLAGS = ../common/libucommon.la @UCOMMON_LIBS@ @OPENSSL_LIBS@ @UCOMMON_CLINK@ $(RELEASE)
+libusecure_la_LDFLAGS = ../common/libucommon.la @UCOMMON_LIBS@ @OPENSSL_LIBS@ @UCOMMON_CLINK@ $(RELEASE) -no-undefined
 libusecure_la_SOURCES = secure.cpp ssl.cpp digest.cpp random.cpp cipher.cpp \
 	sstream.cpp
 
