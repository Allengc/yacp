--- origsrc/diffball-1.0/Makefile.am	2006-06-26 15:05:12.000000000 +0900
+++ src/diffball-1.0/Makefile.am	2011-02-23 11:07:33.955163200 +0900
@@ -3,6 +3,8 @@ AUTOMAKE_OPTIONS        = dist-bzip2 no-
 AM_CFLAGS = -Wall -D_GNU_SOURCE -I$(top_builddir)/include/
 SUBDIRS = libcfile libdiffball include man
 
+INCLUDES = -I$(top_srcdir)/include
+
 if BUILD_DEBUG_CFILE
     cfile_bins = ctest
 else
--- origsrc/diffball-1.0/configure.in	2006-06-26 18:10:56.000000000 +0900
+++ src/diffball-1.0/configure.in	2011-02-23 11:08:14.114099500 +0900
@@ -62,7 +62,7 @@ fi
 
 # keep these here.  they screw with cflags setting, meaning they're *evil*.
 AM_INIT_AUTOMAKE
-AC_PROG_LIBTOOL
+LT_INIT(win32-dll)
 AC_CONFIG_HEADER(config.h)
 
 AM_CONDITIONAL(BUILD_DEBUG_CFILE, test x$enable_debug_cfile = xtrue)
--- origsrc/diffball-1.0/include/Makefile.am	2006-06-25 18:55:30.000000000 +0900
+++ src/diffball-1.0/include/Makefile.am	2011-02-23 11:07:33.964033600 +0900
@@ -1,3 +1,26 @@
 include_HEADERS = cfile.h
 diffballincdir = $(includedir)/diffball
-diffballinc_HEADERS = diffball/*.h $(top_builddir)/config.h
+diffballinc_HEADERS = $(top_builddir)/config.h \
+diffball/adler32.h \
+diffball/api.h \
+diffball/apply-patch.h \
+diffball/bdelta.h \
+diffball/bdiff.h \
+diffball/bit-functions.h \
+diffball/bsdiff.h \
+diffball/command_list.h \
+diffball/dcb-cfh-funcs.h \
+diffball/dcbuffer.h \
+diffball/defs.h \
+diffball/diff-algs.h \
+diffball/errors.h \
+diffball/fdtu.h \
+diffball/formats.h \
+diffball/gdiff.h \
+diffball/hash.h \
+diffball/line-util.h \
+diffball/primes.h \
+diffball/switching.h \
+diffball/udiff.h \
+diffball/xdelta1.h 
+
--- origsrc/diffball-1.0/libcfile/Makefile.am	2006-06-25 18:55:30.000000000 +0900
+++ src/diffball-1.0/libcfile/Makefile.am	2011-02-23 11:07:33.964033600 +0900
@@ -1,4 +1,6 @@
 lib_LTLIBRARIES = libcfile.la
 AM_CFLAGS = -I$(top_builddir)/include/
 libcfile_la_SOURCES = cfile.c
+libcfile_la_LDFLAGS = -no-undefined
 noinst_HEADERS = defs.h
+INCLUDES = -I$(top_srcdir)/include
--- origsrc/diffball-1.0/libdiffball/Makefile.am	2006-06-26 19:41:06.000000000 +0900
+++ src/diffball-1.0/libdiffball/Makefile.am	2011-02-23 11:07:33.972904000 +0900
@@ -6,11 +6,11 @@ FORMATS = bit-functions.c gdiff.c switch
 DCB_FILES  = dcbuffer.c dcb-cfh-funcs.c command_list.c
 DIFF_FILES = diff-algs.c adler32.c primes.c hash.c $(DCB_FILES) errors.c apply-patch.c api.c
 
-libdiffball_la_LDFLAGS = -lm
+libdiffball_la_LDFLAGS = -lm -no-undefined
 libdiffball_la_CFLAGS = $(AM_CFLAGS) -I$(top_builddir)/include
 lib_LTLIBRARIES = libdiffball.la
 libdiffball_la_LIBADD = $(top_builddir)/libcfile/libcfile.la
 libdiffball_la_SOURCES = $(FORMATS) $(DIFF_FILES)
 
-
+INCLUDES = -I$(top_srcdir) -I$(top_srcdir)/include
 
