--- origsrc/commoncpp2-1.8.1/Makefile.am	2010-11-01 06:08:54.000000000 +0900
+++ src/commoncpp2-1.8.1/Makefile.am	2010-11-13 13:30:48.550957300 +0900
@@ -25,7 +25,7 @@ else
 if MSWIN32
 SUBDIRS = inc w32 doc
 else
-SUBDIRS = inc src doc
+SUBDIRS = inc src doc tests
 endif
 endif
 
--- origsrc/commoncpp2-1.8.1/configure.ac	2010-11-01 07:10:07.000000000 +0900
+++ src/commoncpp2-1.8.1/configure.ac	2010-11-13 15:12:27.982458800 +0900
@@ -88,8 +88,7 @@ AC_PROG_CXXCPP
 AC_PROG_CXX
 OST_PROG_CC_POSIX
 NP_PROG_MSC
-AC_LIBTOOL_WIN32_DLL
-AM_PROG_LIBTOOL
+LT_INIT(win32-dll)
 AM_INIT_AUTOMAKE(commoncpp2, [$VERSION])
 AM_CONFIG_HEADER(config.h)
 
@@ -122,9 +121,13 @@ AH_TOP(
 #endif
 
 #if defined(__CYGWIN__)
+#if !defined(_POSIX_REALTIME_SIGNALS)
 #define _POSIX_REALTIME_SIGNALS
+#endif
+#if !defined(_POSIX_THREADS)
 #define _POSIX_THREADS
 #endif
+#endif
 
 #if defined(__APPLE__) && defined(__MACH__)
 #ifndef MACOSX
--- origsrc/commoncpp2-1.8.1/src/Makefile.am	2010-11-01 08:20:41.000000000 +0900
+++ src/commoncpp2-1.8.1/src/Makefile.am	2010-11-13 13:31:14.718584500 +0900
@@ -16,7 +16,7 @@ LT_VERSION = @LT_CCXX_VERSION@
 AM_CXXFLAGS = -I../src -DCCXX_EXPORT_LIBRARY $(THREAD_FLAGS) \
         $(COMMON_FLAGS) -I$(CCXX_DIR) $(DEBUG_FLAGS)
 AM_CFLAGS = $(THREAD_FLAGS)
-INCLUDES = -I$(top_srcdir)/inc 
+INCLUDES = -I$(top_srcdir)/inc -I$(top_builddir)/inc
 RELEASE = $(LT_VERSION) -release $(LT_RELEASE)
 
 if EXTRAS
--- origsrc/commoncpp2-1.8.1/src/in6addr.cpp	2010-11-01 08:42:32.000000000 +0900
+++ src/commoncpp2-1.8.1/src/in6addr.cpp	2010-11-13 14:37:58.912214100 +0900
@@ -352,7 +352,7 @@ void IPV6Address::setAddress(const char
         int    rtn;
 
         hp = gethostbyname2_r(host, AF_INET6, &hb, hbuf, sizeof(hbuf), &rtn);
-#elif (defined(__osf__) || defined(_OSF_SOURCE) || defined(__hpux))
+#elif (defined(__osf__) || defined(_OSF_SOURCE) || defined(__hpux) || defined(__CYGWIN__))
         hp = gethostbyname(host);
 #elif defined(WIN32) && (!defined(_MSC_VER) || _MSC_VER < 1300)
         hp = gethostbyname(host);
--- origsrc/commoncpp2-1.8.1/src/socket.cpp	2010-11-01 09:33:55.000000000 +0900
+++ src/commoncpp2-1.8.1/src/socket.cpp	2010-11-13 14:25:44.576290900 +0900
@@ -1549,7 +1549,7 @@ Socket::Error UDPSocket::join(const IPV4
     int retval = setsockopt(so, IPPROTO_IP, IP_ADD_MEMBERSHIP, (char *)&group, sizeof(group));
     return errSuccess;
 
-#elif defined(IP_ADD_MEMBERSHIP) && defined(SIOCGIFINDEX) && !defined(__FreeBSD__) && !defined(__FreeBSD_kernel__) && !defined(_OSF_SOURCE) && !defined(__hpux) && !defined(__GNU__)
+#elif defined(IP_ADD_MEMBERSHIP) && defined(SIOCGIFINDEX) && !defined(__FreeBSD__) && !defined(__FreeBSD_kernel__) && !defined(_OSF_SOURCE) && !defined(__hpux) && !defined(__GNU__) && !defined(__CYGWIN__)
 
         struct ip_mreqn      group;
     struct sockaddr_in   myaddr;
@@ -1589,7 +1589,7 @@ Socket::Error UDPSocket::join(const IPV4
 Socket::Error UDPSocket::getInterfaceIndex(const char *DeviceName,int& InterfaceIndex)
 {
 #ifndef WIN32
-#if defined(IP_ADD_MEMBERSHIP) && defined(SIOCGIFINDEX) && !defined(__FreeBSD__) && !defined(__FreeBSD_kernel__) && !defined(_OSF_SOURCE) && !defined(__hpux) && !defined(__GNU__)
+#if defined(IP_ADD_MEMBERSHIP) && defined(SIOCGIFINDEX) && !defined(__FreeBSD__) && !defined(__FreeBSD_kernel__) && !defined(_OSF_SOURCE) && !defined(__hpux) && !defined(__GNU__) && !defined(__CYGWIN__)
 
     struct ip_mreqn  mreqn;
     struct ifreq       m_ifreq;
--- origsrc/commoncpp2-1.8.1/src/timer.cpp	2010-11-01 10:00:33.000000000 +0900
+++ src/commoncpp2-1.8.1/src/timer.cpp	2010-11-13 14:21:18.153193300 +0900
@@ -118,7 +118,7 @@ void TimerPort::decTimer(timeout_t timeo
     active = true;
 }
 
-#ifdef  HAVE_HIRES_TIMER
+#if defined(HAVE_HIRES_TIMER) && !defined(__CYGWIN__)
 void TimerPort::sleepTimer(void)
 {
     struct timespec ts;
--- origsrc/commoncpp2-1.8.1/tests/Makefile.am	2010-11-01 01:29:17.000000000 +0900
+++ src/commoncpp2-1.8.1/tests/Makefile.am	2010-11-13 13:31:54.986486900 +0900
@@ -13,7 +13,7 @@ MAINTAINERCLEANFILES = Makefile.in Makef
 
 EXTRA_DIST = README dotests.sh test.sh output.txt vc6.mak Makefile.bcc
 AM_CXXFLAGS = $(THREAD_FLAGS) @WARN_FLAGS@
-INCLUDES = -I$(top_srcdir)/inc
+INCLUDES = -I$(top_srcdir)/inc -I$(top_builddir)/inc
 LDADD = ../src/libccgnu2.la $(THREAD_LIBS) $(DYN_LOADER)
 Z_LIBS = -lz
 
--- origsrc/commoncpp2-1.8.1/tests/Test_Date.h	2010-11-01 01:29:17.000000000 +0900
+++ src/commoncpp2-1.8.1/tests/Test_Date.h	2010-11-13 15:05:59.093263600 +0900
@@ -43,6 +43,7 @@
 #include <cc++/numbers.h> // includes Date
 #include <iostream>
 #include <iomanip>
+#include <cstdlib>
 
 using namespace ost;
 using std::string;
