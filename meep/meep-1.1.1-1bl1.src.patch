--- origsrc/meep-1.1.1/configure.ac	2009-08-22 01:34:34.000000000 +0900
+++ src/meep-1.1.1/configure.ac	2011-05-04 16:21:05.115850600 +0900
@@ -14,7 +14,7 @@ AM_CONFIG_HEADER(config.h)
 AC_CONFIG_MACRO_DIR([m4])
 AM_MAINTAINER_MODE
 AC_SUBST(SHARED_VERSION_INFO)
-AM_ENABLE_SHARED(no) dnl shared libs cause too many headaches to be default
+AM_ENABLE_SHARED(yes) dnl shared libs cause too many headaches to be default
 
 MEEP_SUFFIX=""
 
@@ -98,7 +98,7 @@ AC_SUBST(ARCHFLAG)
 ##############################################################################
 # More checks
 
-AC_PROG_LIBTOOL
+LT_INIT(win32-dll)
 
 AC_CHECK_PROG(LATEX2HTML, latex2html, latex2html)
 if test -z "$LATEX2HTML"; then
--- origsrc/meep-1.1.1/libctl/Makefile.am	2009-08-20 08:06:31.000000000 +0900
+++ src/meep-1.1.1/libctl/Makefile.am	2011-05-04 16:59:11.459859400 +0900
@@ -23,7 +23,7 @@ meep_wrap.o: meep_wrap.cxx $(srcdir)/mee
 if WITH_LIBCTL
 if MAINTAINER_MODE
 meep_wrap.cxx: meep.i meep_op_renames.i meep_enum_renames.i meep_renames.i ctl-io.i meep-ctl-swig.hpp meep_swig_bug_workaround.i $(LIBHDRS)
-	swig -I$(top_srcdir)/src -c++ -guile -o $@ meep.i
+	swig -I$(top_srcdir)/src -c++ -guile -o $@ $(srcdir)/meep.i
 else
 meep_wrap.cxx:
 	echo "#error need --with-maintainer-mode to generate this file" 1>&2
--- origsrc/meep-1.1.1/src/Makefile.am	2009-08-20 03:41:27.000000000 +0900
+++ src/meep-1.1.1/src/Makefile.am	2011-05-04 16:49:01.915275400 +0900
@@ -18,7 +18,7 @@ sources.cpp step.cpp step_db.cpp stress.
 update_eh.cpp mpb.cpp update_pols.cpp vec.cpp step_generic.cpp $(HDRS)	\
 $(BUILT_SOURCES)
 
-libmeep@MEEP_SUFFIX@_la_LDFLAGS = -version-info @SHARED_VERSION_INFO@
+libmeep@MEEP_SUFFIX@_la_LDFLAGS = -version-info @SHARED_VERSION_INFO@ -no-undefined
 
 PRELUDE = "/* This file was automatically generated --- DO NOT EDIT */"
 
--- origsrc/meep-1.1.1/src/bicgstab.cpp	2009-08-20 07:53:58.000000000 +0900
+++ src/meep-1.1.1/src/bicgstab.cpp	2011-05-04 16:44:14.636399700 +0900
@@ -18,6 +18,8 @@
 #include <math.h>
 #include <string.h>
 
+#include <cstdio>
+
 #include "meep/mympi.hpp"
 #include "bicgstab.hpp"
 
