diff -buprN -x CYGWIN-PATCHES -x aclocal.m4~ -x aclocal.m4t -x autom4te.cache -x config.cache -x config.guess -x config.log -x config.status -x config.sub -x '*SlackBuild*' -x '*.egg-info' -x '*.dll' -x '*.exe' -x '*.o' -x '*.gch' -x '*.gem' -x .gitignore -x '*.jpg' -x '*.png' -x '*.qm' -x '*.svgz' -x '*.tif' -x '*.class' -x '*.jlc' -x '*.pyc' -x '*.pyo' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x aclocal.m4 -x configure -x config.h -x '*.h.in' -x COPYING -x INSTALL -x ansi2knr.c -x ar-lib -x config-ml.in -x elisp-comp -x mdate-sh -x mkinstalldirs -x py-compile -x symlink-tree -x test-driver -x texinfo.tex -x ylwrap -x Makefile.in -x GNUmakefile.in -x makefile.in -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x lt~obsolete.m4 -x ltmain.sh -x compile -x depcomp -x install-sh -x missing -x ABOUT-NLS -x config.rpath -x intl -x codeset.m4 -x fcntl-o.m4 -x gettext.m4 -x glibc2.m4 -x glibc21.m4 -x iconv.m4 -x intdiv0.m4 -x intl.m4 -x intldir.m4 -x intlmacosx.m4 -x intmax.m4 -x inttypes-pri.m4 -x inttypes_h.m4 -x lcmessage.m4 -x lib-ld.m4 -x lib-link.m4 -x lib-prefix.m4 -x lock.m4 -x longlong.m4 -x nls.m4 -x po.m4 -x printf-posix.m4 -x progtest.m4 -x size_max.m4 -x stdint_h.m4 -x threadlib.m4 -x uintmax_t.m4 -x visibility.m4 -x wchar_t.m4 -x wint_t.m4 -x xsize.m4 -x boldquot.sed -x en@boldquot.header -x en@quot.header -x insert-header.sin -x Makefile.in.in -x Makevars.template -x quot.sed -x remove-potcdate.sin -x Rules-quot -x inttypes-h.m4 -x longdouble.m4 -x signed.m4 -x ulonglong.m4 -x extern-inline.m4 -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x mate-doc-utils.make -x mate-doc-utils.m4 origsrc/recutils-1.7/Makefile.am src/recutils-1.7/Makefile.am
--- origsrc/recutils-1.7/Makefile.am	2013-11-12 22:09:05.000000000 +0900
+++ src/recutils-1.7/Makefile.am	2015-09-27 14:14:24.368824400 +0900
@@ -28,3 +28,6 @@ perf:
 .PHONY: perf
 
 # End of Makefile.am
+
+pkgconfigdir = $(libdir)/pkgconfig
+pkgconfig_DATA = recutils.pc
diff -buprN -x CYGWIN-PATCHES -x aclocal.m4~ -x aclocal.m4t -x autom4te.cache -x config.cache -x config.guess -x config.log -x config.status -x config.sub -x '*SlackBuild*' -x '*.egg-info' -x '*.dll' -x '*.exe' -x '*.o' -x '*.gch' -x '*.gem' -x .gitignore -x '*.jpg' -x '*.png' -x '*.qm' -x '*.svgz' -x '*.tif' -x '*.class' -x '*.jlc' -x '*.pyc' -x '*.pyo' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x aclocal.m4 -x configure -x config.h -x '*.h.in' -x COPYING -x INSTALL -x ansi2knr.c -x ar-lib -x config-ml.in -x elisp-comp -x mdate-sh -x mkinstalldirs -x py-compile -x symlink-tree -x test-driver -x texinfo.tex -x ylwrap -x Makefile.in -x GNUmakefile.in -x makefile.in -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x lt~obsolete.m4 -x ltmain.sh -x compile -x depcomp -x install-sh -x missing -x ABOUT-NLS -x config.rpath -x intl -x codeset.m4 -x fcntl-o.m4 -x gettext.m4 -x glibc2.m4 -x glibc21.m4 -x iconv.m4 -x intdiv0.m4 -x intl.m4 -x intldir.m4 -x intlmacosx.m4 -x intmax.m4 -x inttypes-pri.m4 -x inttypes_h.m4 -x lcmessage.m4 -x lib-ld.m4 -x lib-link.m4 -x lib-prefix.m4 -x lock.m4 -x longlong.m4 -x nls.m4 -x po.m4 -x printf-posix.m4 -x progtest.m4 -x size_max.m4 -x stdint_h.m4 -x threadlib.m4 -x uintmax_t.m4 -x visibility.m4 -x wchar_t.m4 -x wint_t.m4 -x xsize.m4 -x boldquot.sed -x en@boldquot.header -x en@quot.header -x insert-header.sin -x Makefile.in.in -x Makevars.template -x quot.sed -x remove-potcdate.sin -x Rules-quot -x inttypes-h.m4 -x longdouble.m4 -x signed.m4 -x ulonglong.m4 -x extern-inline.m4 -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x mate-doc-utils.make -x mate-doc-utils.m4 origsrc/recutils-1.7/configure.ac src/recutils-1.7/configure.ac
--- origsrc/recutils-1.7/configure.ac	2014-03-25 07:49:10.000000000 +0900
+++ src/recutils-1.7/configure.ac	2015-09-27 14:13:48.303564400 +0900
@@ -215,7 +215,8 @@ AC_ARG_ENABLE([coverage],
 AM_CONDITIONAL([USE_COVERAGE], [test "x$use_gcov" = "xyes"])
 
 dnl Generate output files
-AC_CONFIG_FILES(Makefile
+AC_CONFIG_FILES(recutils.pc
+                Makefile
                 lib/Makefile
                 libcsv/Makefile
                 src/Makefile
diff -buprN -x CYGWIN-PATCHES -x aclocal.m4~ -x aclocal.m4t -x autom4te.cache -x config.cache -x config.guess -x config.log -x config.status -x config.sub -x '*SlackBuild*' -x '*.egg-info' -x '*.dll' -x '*.exe' -x '*.o' -x '*.gch' -x '*.gem' -x .gitignore -x '*.jpg' -x '*.png' -x '*.qm' -x '*.svgz' -x '*.tif' -x '*.class' -x '*.jlc' -x '*.pyc' -x '*.pyo' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x aclocal.m4 -x configure -x config.h -x '*.h.in' -x COPYING -x INSTALL -x ansi2knr.c -x ar-lib -x config-ml.in -x elisp-comp -x mdate-sh -x mkinstalldirs -x py-compile -x symlink-tree -x test-driver -x texinfo.tex -x ylwrap -x Makefile.in -x GNUmakefile.in -x makefile.in -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x lt~obsolete.m4 -x ltmain.sh -x compile -x depcomp -x install-sh -x missing -x ABOUT-NLS -x config.rpath -x intl -x codeset.m4 -x fcntl-o.m4 -x gettext.m4 -x glibc2.m4 -x glibc21.m4 -x iconv.m4 -x intdiv0.m4 -x intl.m4 -x intldir.m4 -x intlmacosx.m4 -x intmax.m4 -x inttypes-pri.m4 -x inttypes_h.m4 -x lcmessage.m4 -x lib-ld.m4 -x lib-link.m4 -x lib-prefix.m4 -x lock.m4 -x longlong.m4 -x nls.m4 -x po.m4 -x printf-posix.m4 -x progtest.m4 -x size_max.m4 -x stdint_h.m4 -x threadlib.m4 -x uintmax_t.m4 -x visibility.m4 -x wchar_t.m4 -x wint_t.m4 -x xsize.m4 -x boldquot.sed -x en@boldquot.header -x en@quot.header -x insert-header.sin -x Makefile.in.in -x Makevars.template -x quot.sed -x remove-potcdate.sin -x Rules-quot -x inttypes-h.m4 -x longdouble.m4 -x signed.m4 -x ulonglong.m4 -x extern-inline.m4 -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x mate-doc-utils.make -x mate-doc-utils.m4 origsrc/recutils-1.7/recutils.pc.in src/recutils-1.7/recutils.pc.in
--- origsrc/recutils-1.7/recutils.pc.in	1970-01-01 09:00:00.000000000 +0900
+++ src/recutils-1.7/recutils.pc.in	2015-09-27 14:13:58.912472800 +0900
@@ -0,0 +1,10 @@
+prefix=@prefix@
+exec_prefix=@exec_prefix@
+libdir=@libdir@
+includedir=@includedir@
+
+Name: recutils
+Description: Tools and libraries to access recfiles
+Version: @VERSION@
+Libs: -L${libdir} -lrec
+Cflags: -I${includedir}
diff -buprN -x CYGWIN-PATCHES -x aclocal.m4~ -x aclocal.m4t -x autom4te.cache -x config.cache -x config.guess -x config.log -x config.status -x config.sub -x '*SlackBuild*' -x '*.egg-info' -x '*.dll' -x '*.exe' -x '*.o' -x '*.gch' -x '*.gem' -x .gitignore -x '*.jpg' -x '*.png' -x '*.qm' -x '*.svgz' -x '*.tif' -x '*.class' -x '*.jlc' -x '*.pyc' -x '*.pyo' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x aclocal.m4 -x configure -x config.h -x '*.h.in' -x COPYING -x INSTALL -x ansi2knr.c -x ar-lib -x config-ml.in -x elisp-comp -x mdate-sh -x mkinstalldirs -x py-compile -x symlink-tree -x test-driver -x texinfo.tex -x ylwrap -x Makefile.in -x GNUmakefile.in -x makefile.in -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x lt~obsolete.m4 -x ltmain.sh -x compile -x depcomp -x install-sh -x missing -x ABOUT-NLS -x config.rpath -x intl -x codeset.m4 -x fcntl-o.m4 -x gettext.m4 -x glibc2.m4 -x glibc21.m4 -x iconv.m4 -x intdiv0.m4 -x intl.m4 -x intldir.m4 -x intlmacosx.m4 -x intmax.m4 -x inttypes-pri.m4 -x inttypes_h.m4 -x lcmessage.m4 -x lib-ld.m4 -x lib-link.m4 -x lib-prefix.m4 -x lock.m4 -x longlong.m4 -x nls.m4 -x po.m4 -x printf-posix.m4 -x progtest.m4 -x size_max.m4 -x stdint_h.m4 -x threadlib.m4 -x uintmax_t.m4 -x visibility.m4 -x wchar_t.m4 -x wint_t.m4 -x xsize.m4 -x boldquot.sed -x en@boldquot.header -x en@quot.header -x insert-header.sin -x Makefile.in.in -x Makevars.template -x quot.sed -x remove-potcdate.sin -x Rules-quot -x inttypes-h.m4 -x longdouble.m4 -x signed.m4 -x ulonglong.m4 -x extern-inline.m4 -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x mate-doc-utils.make -x mate-doc-utils.m4 origsrc/recutils-1.7/src/Makefile.am src/recutils-1.7/src/Makefile.am
--- origsrc/recutils-1.7/src/Makefile.am	2014-02-25 05:55:06.000000000 +0900
+++ src/recutils-1.7/src/Makefile.am	2015-09-27 12:13:40.249816800 +0900
@@ -61,7 +61,7 @@ endif
 
 AM_LDFLAGS = -no-undefined
 AM_CPPFLAGS = -I$(top_srcdir)/lib -DLOCALEDIR=\"$(localedir)\"
-librec_la_LDFLAGS = -version-info 1:0:0
+librec_la_LDFLAGS = $(AM_LDFLAGS) -version-info 1:0:0
 librec_la_LIBADD = $(top_builddir)/lib/librecutils.la \
                    $(LIB_CLOCK_GETTIME)
 
diff -buprN -x CYGWIN-PATCHES -x aclocal.m4~ -x aclocal.m4t -x autom4te.cache -x config.cache -x config.guess -x config.log -x config.status -x config.sub -x '*SlackBuild*' -x '*.egg-info' -x '*.dll' -x '*.exe' -x '*.o' -x '*.gch' -x '*.gem' -x .gitignore -x '*.jpg' -x '*.png' -x '*.qm' -x '*.svgz' -x '*.tif' -x '*.class' -x '*.jlc' -x '*.pyc' -x '*.pyo' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x aclocal.m4 -x configure -x config.h -x '*.h.in' -x COPYING -x INSTALL -x ansi2knr.c -x ar-lib -x config-ml.in -x elisp-comp -x mdate-sh -x mkinstalldirs -x py-compile -x symlink-tree -x test-driver -x texinfo.tex -x ylwrap -x Makefile.in -x GNUmakefile.in -x makefile.in -x libtool.m4 -x ltoptions.m4 -x ltsugar.m4 -x ltversion.m4 -x lt~obsolete.m4 -x ltmain.sh -x compile -x depcomp -x install-sh -x missing -x ABOUT-NLS -x config.rpath -x intl -x codeset.m4 -x fcntl-o.m4 -x gettext.m4 -x glibc2.m4 -x glibc21.m4 -x iconv.m4 -x intdiv0.m4 -x intl.m4 -x intldir.m4 -x intlmacosx.m4 -x intmax.m4 -x inttypes-pri.m4 -x inttypes_h.m4 -x lcmessage.m4 -x lib-ld.m4 -x lib-link.m4 -x lib-prefix.m4 -x lock.m4 -x longlong.m4 -x nls.m4 -x po.m4 -x printf-posix.m4 -x progtest.m4 -x size_max.m4 -x stdint_h.m4 -x threadlib.m4 -x uintmax_t.m4 -x visibility.m4 -x wchar_t.m4 -x wint_t.m4 -x xsize.m4 -x boldquot.sed -x en@boldquot.header -x en@quot.header -x insert-header.sin -x Makefile.in.in -x Makevars.template -x quot.sed -x remove-potcdate.sin -x Rules-quot -x inttypes-h.m4 -x longdouble.m4 -x signed.m4 -x ulonglong.m4 -x extern-inline.m4 -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x mate-doc-utils.make -x mate-doc-utils.m4 origsrc/recutils-1.7/src/rec-db.c src/recutils-1.7/src/rec-db.c
--- origsrc/recutils-1.7/src/rec-db.c	2014-03-18 07:08:36.000000000 +0900
+++ src/recutils-1.7/src/rec-db.c	2015-09-27 12:13:40.249816800 +0900
@@ -1497,7 +1497,9 @@ rec_db_add_random_indexes (size_t **inde
 
   size_t i;
   char random_state[128];
+#if defined(HAVE_STRUCT_RANDOM_DATA)
   struct random_data random_data;
+#endif
 
   *index = malloc (sizeof(size_t) * ((num + 1) * 2));
   if (*index == NULL)
@@ -1512,14 +1514,20 @@ rec_db_add_random_indexes (size_t **inde
     }
 
   /* Insert the random indexes.  */
-
+#if defined(HAVE_STRUCT_RANDOM_DATA)
   memset (&random_data, 0, sizeof (random_data));
   initstate_r (time(NULL), (char *) &random_state, 128, &random_data);
+#else
+  initstate (time(NULL), (char *) &random_state, 128);
+#endif
   for (i = 0; i < (num * 2); i = i + 2)
     {
       size_t random_value = 0;
-      
+#if defined(HAVE_STRUCT_RANDOM_DATA)
       random_r (&random_data, (int32_t *) &random_value); /* Can't fail.  */
+#else
+      random_value = random ();
+#endif
       random_value = random_value % limit;
 
       /* Avoid having repeated random indexes.  */
