--- origsrc/msgpack-0.5.2/configure.in	2010-07-14 17:05:11.000000000 +0900
+++ src/msgpack-0.5.2/configure.in	2010-07-28 01:42:52.117625000 +0900
@@ -25,6 +25,7 @@ fi
 AM_CONDITIONAL(ENABLE_CXX, test "$enable_cxx" != "no")
 
 
+AC_LIBTOOL_WIN32_DLL
 AC_PROG_LIBTOOL
 AM_PROG_AS
 
--- origsrc/msgpack-0.5.2/src/Makefile.am	2010-07-06 23:24:25.000000000 +0900
+++ src/msgpack-0.5.2/src/Makefile.am	2010-07-28 01:44:35.398875000 +0900
@@ -14,7 +14,7 @@ libmsgpack_la_SOURCES += \
 endif
 
 # -version-info CURRENT:REVISION:AGE
-libmsgpack_la_LDFLAGS = -version-info 3:0:0
+libmsgpack_la_LDFLAGS = -version-info 3:0:0 -no-undefined
 
 
 # backward compatibility
@@ -27,7 +27,7 @@ libmsgpackc_la_SOURCES = \
 		vrefbuffer.c \
 		zone.c
 
-libmsgpackc_la_LDFLAGS = -version-info 2:0:0
+libmsgpackc_la_LDFLAGS = -version-info 2:0:0 -no-undefined
 
 
 nobase_include_HEADERS = \
--- origsrc/msgpack-0.5.2/test/Makefile.am	2010-07-06 16:44:08.000000000 +0900
+++ src/msgpack-0.5.2/test/Makefile.am	2010-07-28 01:44:09.383250000 +0900
@@ -1,7 +1,7 @@
 
-AM_CPPFLAGS   = -I../src
-AM_C_CPPFLAGS = -I../src
-AM_LDFLAGS = ../src/libmsgpack.la -lgtest_main
+AM_CPPFLAGS   = -I$(top_srcdir)/src
+AM_C_CPPFLAGS = -I$(top_srcdir)/src
+AM_LDFLAGS = $(top_builddir)/src/libmsgpack.la -lgtest_main
 
 check_PROGRAMS = \
 		zone \
