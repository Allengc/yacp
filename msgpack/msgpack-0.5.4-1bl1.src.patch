--- origsrc/msgpack-0.5.4/configure.in	2010-08-29 18:24:42.000000000 +0900
+++ src/msgpack-0.5.4/configure.in	2010-09-12 12:52:43.796625000 +0900
@@ -25,7 +25,7 @@ fi
 AM_CONDITIONAL(ENABLE_CXX, test "$enable_cxx" != "no")
 
 
-AC_PROG_LIBTOOL
+LT_INIT(win32-dll)
 AM_PROG_AS
 
 
--- origsrc/msgpack-0.5.4/src/Makefile.am	2010-08-27 17:11:29.000000000 +0900
+++ src/msgpack-0.5.4/src/Makefile.am	2010-09-12 12:49:50.874750000 +0900
@@ -14,7 +14,7 @@ libmsgpack_la_SOURCES += \
 endif
 
 # -version-info CURRENT:REVISION:AGE
-libmsgpack_la_LDFLAGS = -version-info 3:0:0
+libmsgpack_la_LDFLAGS = -version-info 3:0:0 -no-undefined
 
 
 # backward compatibility
@@ -27,7 +27,7 @@ libmsgpackc_la_SOURCES = \
 		vrefbuffer.c \
 		zone.c
 
-libmsgpackc_la_LDFLAGS = -version-info 2:0:0
+libmsgpackc_la_LDFLAGS = -version-info 2:0:0 -no-undefined
 
 
 nobase_include_HEADERS = \
--- origsrc/msgpack-0.5.4/test/Makefile.am	2010-08-27 17:38:19.000000000 +0900
+++ src/msgpack-0.5.4/test/Makefile.am	2010-09-12 12:49:50.874750000 +0900
@@ -1,7 +1,7 @@
 
-AM_CPPFLAGS   = -I../src
-AM_C_CPPFLAGS = -I../src
-AM_LDFLAGS = ../src/libmsgpack.la -lgtest_main
+AM_CPPFLAGS   = -I$(top_srcdir)/src
+AM_C_CPPFLAGS = -I$(top_srcdir)/src
+AM_LDFLAGS = $(top_builddir)/src/libmsgpack.la -lgtest_main
 
 check_PROGRAMS = \
 		zone \
