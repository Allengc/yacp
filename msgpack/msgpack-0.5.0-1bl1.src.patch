--- origsrc/msgpack-0.5.0/configure.in	2010-04-29 22:41:12.000000000 +0900
+++ src/msgpack-0.5.0/configure.in	2010-05-01 13:45:05.842641700 +0900
@@ -12,6 +12,7 @@ CXXFLAGS="-O4 -Wall $CXXFLAGS"
 AC_PROG_CC
 AC_PROG_CXX
 
+AC_LIBTOOL_WIN32_DLL
 AC_PROG_LIBTOOL
 AM_PROG_AS
 AM_PROG_CC_C_O
--- origsrc/msgpack-0.5.0/Makefile.am	2010-04-26 21:51:26.000000000 +0900
+++ src/msgpack-0.5.0/Makefile.am	2010-05-01 13:45:50.639516700 +0900
@@ -9,7 +9,7 @@ libmsgpack_la_SOURCES = \
 		object.cpp
 
 # -version-info CURRENT:REVISION:AGE
-libmsgpack_la_LDFLAGS = -version-info 3:0:0
+libmsgpack_la_LDFLAGS = -version-info 3:0:0 -no-undefined
 
 
 # backward compatibility
@@ -21,7 +21,7 @@ libmsgpackc_la_SOURCES = \
 		vrefbuffer.c \
 		zone.c
 
-libmsgpackc_la_LDFLAGS = -version-info 2:0:0
+libmsgpackc_la_LDFLAGS = -version-info 2:0:0 -no-undefined
 
 # work around for duplicated file name
 kumo_manager_CFLAGS = $(AM_CFLAGS)
--- origsrc/msgpack-0.5.0/test/Makefile.am	2010-04-25 21:25:36.000000000 +0900
+++ src/msgpack-0.5.0/test/Makefile.am	2010-05-01 14:05:35.295766700 +0900
@@ -1,6 +1,6 @@
 
-AM_CPPFLAGS   = -I..
-AM_C_CPPFLAGS = -I..
+AM_CPPFLAGS   = -I$(top_srcdir)
+AM_C_CPPFLAGS = -I$(top_srcdir)
 AM_LDFLAGS = ../libmsgpack.la -lgtest_main
 
 check_PROGRAMS = \
