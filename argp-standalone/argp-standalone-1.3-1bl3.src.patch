--- origsrc/argp-standalone-1.3/Makefile.am	2004-02-24 02:57:28.000000000 +0900
+++ src/argp-standalone-1.3/Makefile.am	2011-04-10 17:56:30.113056900 +0900
@@ -23,18 +23,19 @@ SUBDIRS = . testsuite
 
 LIBOBJS = @LIBOBJS@
 
-noinst_LIBRARIES = libargp.a
+lib_LTLIBRARIES = libargp.la
 noinst_PROGRAMS = argp-test
-noinst_HEADERS = argp.h argp-fmtstream.h argp-namefrob.h # argp-comp.h
+include_HEADERS = argp.h argp-fmtstream.h argp-namefrob.h # argp-comp.h
 
 EXTRA_DIST = mempcpy.c strchrnul.c strndup.c Versions
 
 # Leaves out argp-fs-xinl.c and argp-xinl.c 
-libargp_a_SOURCES = argp-ba.c argp-eexst.c argp-fmtstream.c \
+libargp_la_SOURCES = argp-ba.c argp-eexst.c argp-fmtstream.c \
 		    argp-help.c argp-parse.c argp-pv.c \
-		    argp-pvh.c
+		    argp-pvh.c strchrnul.c
+libargp_la_LDFLAGS = -no-undefined
 
-libargp_a_LIBADD = $(LIBOBJS)
+libargp_la_LIBADD = $(LIBOBJS)
 
-argp_test_LDADD = libargp.a
+argp_test_LDADD = libargp.la
 
--- origsrc/argp-standalone-1.3/configure.ac	2004-02-24 02:57:29.000000000 +0900
+++ src/argp-standalone-1.3/configure.ac	2011-04-10 17:57:26.293840900 +0900
@@ -15,7 +15,7 @@ AC_GNU_SOURCE
 # Checks for programs.
 AC_PROG_CC
 AC_PROG_MAKE_SET
-AC_PROG_RANLIB
+LT_INIT(win32-dll)
 AM_PROG_CC_STDC
 
 if test "x$am_cv_prog_cc_stdc" = xno ; then
@@ -40,8 +40,6 @@ AC_FUNC_ALLOCA
 AC_FUNC_VPRINTF
 AC_CHECK_FUNCS(strerror)
 
-AC_REPLACE_FUNCS(mempcpy strndup strchrnul)
-
 dnl ARGP_CHECK_FUNC(includes, function-call [, if-found [, if-not-found]])
 AC_DEFUN([ARGP_CHECK_FUNC],
   [AS_VAR_PUSHDEF([ac_func], m4_substr([$2], 0, m4_index([$2], [(])))
--- origsrc/argp-standalone-1.3/testsuite/Makefile.am	2003-02-05 04:38:52.000000000 +0900
+++ src/argp-standalone-1.3/testsuite/Makefile.am	2011-04-10 17:56:30.173143300 +0900
@@ -5,7 +5,7 @@ TS_ALL = $(TS_PROGS) $(TS_SH)
 
 noinst_PROGRAMS = $(TS_PROGS) ex1 ex3 ex4
 
-LDADD = ../libargp.a
+LDADD = $(top_builddir)/libargp.la
 
 EXTRA_DIST = $(TS_SH) run-tests
 CLEANFILES = test.out
