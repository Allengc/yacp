--- origsrc/lwp-2.6/configure.in	2010-03-18 05:32:51.000000000 +0900
+++ src/lwp-2.6/configure.in	2010-05-13 15:51:36.091856800 +0900
@@ -30,6 +30,7 @@ AC_PROG_CPP
 AM_PROG_AS
 AC_PROG_INSTALL
 AC_PROG_MAKE_SET
+AC_LIBTOOL_WIN32_DLL
 AC_PROG_LIBTOOL
 
 dnl pkg-config stuff
--- origsrc/lwp-2.6/src/Makefile.am	2008-08-09 04:35:28.000000000 +0900
+++ src/lwp-2.6/src/Makefile.am	2010-05-13 15:52:03.919981800 +0900
@@ -10,7 +10,7 @@ liblwp_la_SOURCES = fasttime.c iomgr.c l
 		    lwp_ucontext.c lwp_ucontext.h lwp_stacktrace.c \
 		    lwp_stacktrace.h lwp.private.h valgrind.h
 liblwp_la_CPPFLAGS = $(AM_CPPFLAGS) -DLWPDEBUG
-liblwp_la_LDFLAGS = $(LIBTOOL_LDFLAGS)
+liblwp_la_LDFLAGS = $(LIBTOOL_LDFLAGS) -no-undefined
 
 testlwp_static_SOURCES = testlwp.c
 testlwp_static_LDFLAGS = -static
--- origsrc/lwp-2.6/src-pt/Makefile.am	2007-12-12 02:29:05.000000000 +0900
+++ src/lwp-2.6/src-pt/Makefile.am	2010-05-13 15:52:23.076231800 +0900
@@ -14,7 +14,7 @@ AM_CPPFLAGS = -I$(top_srcdir)/include -D
 liblwp_pt_la_SOURCES = iomgr_pt.c lock_pt.c lwp_pt.c preempt_pt.c \
     lwp.private_pt.h dllist.h
 liblwp_pt_la_LIBADD = fasttime_pt.lo timer_pt.lo
-liblwp_pt_la_LDFLAGS = -version-info $(LIBTOOL_VERSION) $(LIBPTHREAD)
+liblwp_pt_la_LDFLAGS = -version-info $(LIBTOOL_VERSION) $(LIBPTHREAD) -no-undefined
 
 noinst_PROGRAMS = $(BUILD_BIN)
 cswitch_pt_SOURCES =
