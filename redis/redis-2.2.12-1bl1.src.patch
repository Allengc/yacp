--- origsrc/redis-2.2.12/Makefile.am	1970-01-01 09:00:00.000000000 +0900
+++ src/redis-2.2.12/Makefile.am	2011-08-28 00:18:35.545797100 +0900
@@ -0,0 +1 @@
+SUBDIRS = deps src
--- origsrc/redis-2.2.12/configure.ac	1970-01-01 09:00:00.000000000 +0900
+++ src/redis-2.2.12/configure.ac	2011-08-28 00:25:23.718280200 +0900
@@ -0,0 +1,54 @@
+#                                               -*- Autoconf -*-
+# Process this file with autoconf to produce a configure script.
+
+AC_PREREQ([2.68])
+AC_INIT([redis], [2.2.12], [http://redis.io/])
+AC_CONFIG_SRCDIR([deps/hiredis/async.c])
+AC_CONFIG_HEADERS([config.h])
+AM_INIT_AUTOMAKE
+
+# Checks for programs.
+AC_PROG_CC
+AC_PROG_INSTALL
+LT_INIT([disable-static])
+
+# Checks for libraries.
+PKG_CHECK_MODULES(LIBEVENT, libevent)
+
+# Checks for header files.
+AC_CHECK_HEADERS([arpa/inet.h fcntl.h float.h inttypes.h limits.h netdb.h netinet/in.h stdint.h stdlib.h string.h strings.h sys/ioctl.h sys/socket.h sys/time.h syslog.h termios.h unistd.h])
+
+# Checks for typedefs, structures, and compiler characteristics.
+AC_C_INLINE
+AC_TYPE_INT16_T
+AC_TYPE_INT32_T
+AC_TYPE_INT64_T
+AC_TYPE_INT8_T
+AC_TYPE_OFF_T
+AC_TYPE_PID_T
+AC_TYPE_SIZE_T
+AC_TYPE_SSIZE_T
+AC_TYPE_UINT16_T
+AC_TYPE_UINT32_T
+AC_TYPE_UINT64_T
+AC_TYPE_UINT8_T
+
+# Checks for library functions.
+AC_FUNC_ERROR_AT_LINE
+AC_FUNC_FORK
+AC_FUNC_FSEEKO
+AC_FUNC_MALLOC
+AC_FUNC_MMAP
+AC_FUNC_REALLOC
+AC_FUNC_STRCOLL
+AC_FUNC_STRTOD
+AC_FUNC_WAIT3
+AC_CHECK_FUNCS([atexit dup2 ftruncate getcwd gethostbyname gettimeofday inet_ntoa memmove memset munmap select socket strcasecmp strchr strdup strerror strncasecmp strstr strtol])
+
+AC_CONFIG_FILES([Makefile
+                 deps/Makefile
+                 deps/hiredis/Makefile
+                 deps/hiredis/adapters/Makefile
+                 deps/linenoise/Makefile
+                 src/Makefile])
+AC_OUTPUT
--- origsrc/redis-2.2.12/deps/Makefile.am	1970-01-01 09:00:00.000000000 +0900
+++ src/redis-2.2.12/deps/Makefile.am	2011-08-28 00:14:29.245959800 +0900
@@ -0,0 +1 @@
+SUBDIRS = hiredis linenoise
--- origsrc/redis-2.2.12/deps/hiredis/Makefile.am	1970-01-01 09:00:00.000000000 +0900
+++ src/redis-2.2.12/deps/hiredis/Makefile.am	2011-08-28 00:12:57.527390400 +0900
@@ -0,0 +1,19 @@
+SUBDIRS = adapters
+
+lib_LTLIBRARIES = libhiredis.la
+
+hiredis_includedir = $(includedir)/hiredis
+hiredis_include_HEADERS = hiredis.h async.h
+
+bin_PROGRAMS = hiredis-example-libevent hiredis-test
+
+TESTS = hiredis-test
+
+hiredis_example_libevent_SOURCES = example-libevent.c
+hiredis_example_libevent_LDADD = libhiredis.la $(LIBEVENT_LIBS)
+
+hiredis_test_SOURCES = test.c
+hiredis_test_LDADD = libhiredis.la
+
+libhiredis_la_SOURCES = net.c hiredis.c sds.c async.c
+libhiredis_la_LDFLAGS = -no-undefined
--- origsrc/redis-2.2.12/deps/hiredis/adapters/Makefile.am	1970-01-01 09:00:00.000000000 +0900
+++ src/redis-2.2.12/deps/hiredis/adapters/Makefile.am	2011-08-28 00:03:53.622709100 +0900
@@ -0,0 +1,2 @@
+hiredis_adapters_includedir = $(includedir)/hiredis/adapters
+hiredis_adapters_include_HEADERS = ae.h libev.h libevent.h
--- origsrc/redis-2.2.12/deps/linenoise/Makefile.am	1970-01-01 09:00:00.000000000 +0900
+++ src/redis-2.2.12/deps/linenoise/Makefile.am	2011-08-28 00:13:58.392964000 +0900
@@ -0,0 +1,2 @@
+noinst_LTLIBRARIES = liblinenoise.la
+liblinenoise_la_SOURCES = linenoise.c
\ No newline at end of file
--- origsrc/redis-2.2.12/src/Makefile.am	1970-01-01 09:00:00.000000000 +0900
+++ src/redis-2.2.12/src/Makefile.am	2011-08-28 01:02:51.136188400 +0900
@@ -0,0 +1,16 @@
+INCLUDES = -I$(top_srcdir)/deps/hiredis -I$(top_srcdir)/deps/linenoise
+
+bin_PROGRAMS = redis-server redis-benchmark redis-cli redis-check-dump redis-check-aof
+
+redis_server_SOURCES = adlist.c ae.c anet.c dict.c redis.c sds.c zmalloc.c lzf_c.c lzf_d.c pqsort.c zipmap.c sha1.c ziplist.c release.c networking.c util.c object.c db.c replication.c rdb.c t_string.c t_list.c t_set.c t_zset.c t_hash.c config.c aof.c vm.c pubsub.c multi.c debug.c sort.c intset.c syncio.c slowlog.c
+
+redis_benchmark_SOURCES = ae.c anet.c redis-benchmark.c sds.c adlist.c zmalloc.c
+redis_benchmark_LDADD = $(top_builddir)/deps/hiredis/libhiredis.la
+
+redis_cli_SOURCES = anet.c sds.c adlist.c redis-cli.c zmalloc.c release.c
+redis_cli_LDADD = $(top_builddir)/deps/hiredis/libhiredis.la $(top_builddir)/deps/linenoise/liblinenoise.la
+
+redis_check_dump_SOURCES = redis-check-dump.c lzf_c.c lzf_d.c
+
+redis_check_aof_SOURCES = redis-check-aof.c
+
--- origsrc/redis-2.2.12/src/redis.c	2011-07-22 19:22:26.000000000 +0900
+++ src/redis-2.2.12/src/redis.c	2011-08-28 00:49:24.331762300 +0900
@@ -54,6 +54,10 @@
 #include <pthread.h>
 #include <sys/resource.h>
 
+#if !defined(SA_ONSTACK)
+#define SA_ONSTACK 0x00000000
+#endif
+
 /* Our shared "common" objects */
 
 struct sharedObjectsStruct shared;
--- origsrc/redis-2.2.12/src/release.h	1970-01-01 09:00:00.000000000 +0900
+++ src/redis-2.2.12/src/release.h	2011-08-28 00:57:41.520983600 +0900
@@ -0,0 +1,2 @@
+#define REDIS_GIT_SHA1 "00000000"
+#define REDIS_GIT_DIRTY "0"
