--- origsrc/ctemplate-0.97/Makefile.am	2010-04-09 12:42:10.000000000 +0900
+++ src/ctemplate-0.97/Makefile.am	2010-07-17 17:36:48.320727800 +0900
@@ -124,7 +124,7 @@ libctemplate_la_SOURCES = $(nodist_ctemp
 	src/htmlparser/statemachine.h src/htmlparser/statemachine.cc \
 	src/htmlparser/htmlparser_cpp.h
 libctemplate_la_CXXFLAGS = $(PTHREAD_CFLAGS) -DNDEBUG $(AM_CXXFLAGS)
-libctemplate_la_LDFLAGS = $(PTHREAD_CFLAGS) -export-symbols-regex $(CTEMPLATE_SYMBOLS)
+libctemplate_la_LDFLAGS = $(PTHREAD_CFLAGS) -export-symbols-regex $(CTEMPLATE_SYMBOLS) -no-undefined
 libctemplate_la_LIBADD = $(PTHREAD_LIBS)
 
 # For MinGW, we need to bring in the windows port files
@@ -138,7 +138,7 @@ lib_LTLIBRARIES += libctemplate_nothread
 libctemplate_nothreads_la_SOURCES = $(libctemplate_la_SOURCES)
 libctemplate_nothreads_la_DEPENDENCIES = $(libctemplate_la_DEPENDENCIES)
 libctemplate_nothreads_la_CXXFLAGS = -DNDEBUG -DNO_THREADS $(AM_CXXFLAGS)
-libctemplate_nothreads_la_LDFLAGS = -export-symbols-regex $(CTEMPLATE_SYMBOLS)
+libctemplate_nothreads_la_LDFLAGS = -export-symbols-regex $(CTEMPLATE_SYMBOLS) -no-undefined
 
 # For our tests, we want versions of these libraries that include asserts.
 noinst_LTLIBRARIES += libctemplate_debug.la
--- origsrc/ctemplate-0.97/configure.ac	2010-04-20 06:08:20.000000000 +0900
+++ src/ctemplate-0.97/configure.ac	2010-07-17 17:34:54.101977800 +0900
@@ -42,6 +42,7 @@ esac
 AM_CONDITIONAL(MINGW, expr $host : '.*-mingw' >/dev/null 2>&1)
 
 # Uncomment this if you'll be exporting libraries (.so's)
+AC_LIBTOOL_WIN32_DLL
 AC_PROG_LIBTOOL
 AC_SUBST(LIBTOOL_DEPS)
 
