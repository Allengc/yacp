--- origsrc/bullet-2.77.2156svn/Demos/AllBulletDemos/Makefile.am	2010-08-08 00:06:53.000000000 +0900
+++ src/bullet-2.77.2156svn/Demos/AllBulletDemos/Makefile.am	2010-08-08 02:41:05.410950900 +0900
@@ -1,33 +1,33 @@
 noinst_PROGRAMS=AllBulletDemo
 
 AllBulletDemo_SOURCES=\
-		      	../SoftDemo/SoftDemo.cpp \
-			../ConstraintDemo/ConstraintDemo.cpp \
-			../ForkLiftDemo/ForkLiftDemo.cpp \
-			../RagdollDemo/RagdollDemo.cpp \
-			../BasicDemo/BasicDemo.cpp \
-			../CcdPhysicsDemo/CcdPhysicsDemo.cpp \
-			../SliderConstraintDemo/SliderConstraintDemo.cpp \
-			../ConcaveRaycastDemo/ConcaveRaycastDemo.cpp \
-			../Raytracer/Raytracer.cpp \
-			../BspDemo/BspDemo.cpp \
-			../BspDemo/BspLoader.cpp \
-			../BspDemo/BspConverter.cpp \
-			../ConcaveConvexcastDemo/ConcaveConvexcastDemo.cpp \
-			../ConvexDecompositionDemo/ConvexDecompositionDemo.cpp \
-			../GimpactTestDemo/GimpactTestDemo.cpp \
-			../GjkConvexCastDemo/LinearConvexCastDemo.cpp \
-			../ConcaveDemo/ConcavePhysicsDemo.cpp \
-			../DynamicControlDemo/MotorDemo.cpp \
+		      	$(top_srcdir)/Demos/SoftDemo/SoftDemo.cpp \
+			$(top_srcdir)/Demos/ConstraintDemo/ConstraintDemo.cpp \
+			$(top_srcdir)/Demos/ForkLiftDemo/ForkLiftDemo.cpp \
+			$(top_srcdir)/Demos/RagdollDemo/RagdollDemo.cpp \
+			$(top_srcdir)/Demos/BasicDemo/BasicDemo.cpp \
+			$(top_srcdir)/Demos/CcdPhysicsDemo/CcdPhysicsDemo.cpp \
+			$(top_srcdir)/Demos/SliderConstraintDemo/SliderConstraintDemo.cpp \
+			$(top_srcdir)/Demos/ConcaveRaycastDemo/ConcaveRaycastDemo.cpp \
+			$(top_srcdir)/Demos/Raytracer/Raytracer.cpp \
+			$(top_srcdir)/Demos/BspDemo/BspDemo.cpp \
+			$(top_srcdir)/Demos/BspDemo/BspLoader.cpp \
+			$(top_srcdir)/Demos/BspDemo/BspConverter.cpp \
+			$(top_srcdir)/Demos/ConcaveConvexcastDemo/ConcaveConvexcastDemo.cpp \
+			$(top_srcdir)/Demos/ConvexDecompositionDemo/ConvexDecompositionDemo.cpp \
+			$(top_srcdir)/Demos/GimpactTestDemo/GimpactTestDemo.cpp \
+			$(top_srcdir)/Demos/GjkConvexCastDemo/LinearConvexCastDemo.cpp \
+			$(top_srcdir)/Demos/ConcaveDemo/ConcavePhysicsDemo.cpp \
+			$(top_srcdir)/Demos/DynamicControlDemo/MotorDemo.cpp \
 			DemoEntries.cpp \
 			DemoEntries.h\
 			Main.cpp
 AllBulletDemo_CXXFLAGS=\
-		       	-I@top_builddir@/src \
-		       	-I@top_builddir@/Extras/GIMPACTUtils \
-		       	-I@top_builddir@/Extras/ConvexDecomposition \
-		       	-I@top_builddir@/Extras \
-			-I@top_builddir@/Demos/OpenGL \
-			-I@top_builddir@/Demos/SoftDemo \
+		       	-I$(top_srcdir)/src \
+		       	-I$(top_srcdir)/Extras/GIMPACTUtils \
+		       	-I$(top_srcdir)/Extras/ConvexDecomposition \
+		       	-I$(top_srcdir)/Extras \
+			-I$(top_srcdir)/Demos/OpenGL \
+			-I$(top_srcdir)/Demos/SoftDemo \
 			$(CXXFLAGS)
 AllBulletDemo_LDADD=-L../OpenGL -lbulletopenglsupport -L../../src -L../../Extras -lgimpactutils -lconvexdecomposition -lbulletsoftbody -lbulletdynamics -lbulletcollision -lbulletmath -lglui @opengl_LIBS@
--- origsrc/bullet-2.77.2156svn/Demos/BasicDemo/Makefile.am	2010-08-08 00:06:29.000000000 +0900
+++ src/bullet-2.77.2156svn/Demos/BasicDemo/Makefile.am	2010-08-08 02:28:17.692200900 +0900
@@ -1,5 +1,5 @@
 noinst_PROGRAMS=BasicDemo
 
 BasicDemo_SOURCES=BasicDemo.cpp BasicDemo.h main.cpp
-BasicDemo_CXXFLAGS=-I@top_builddir@/src -I@top_builddir@/Demos/OpenGL $(CXXFLAGS)
+BasicDemo_CXXFLAGS=-I$(top_srcdir)/src -I$(top_srcdir)/Demos/OpenGL $(CXXFLAGS)
 BasicDemo_LDADD=-L../OpenGL -lbulletopenglsupport -L../../src -lbulletdynamics -lbulletcollision -lbulletmath @opengl_LIBS@
--- origsrc/bullet-2.77.2156svn/Demos/CcdPhysicsDemo/Makefile.am	2010-08-08 00:06:46.000000000 +0900
+++ src/bullet-2.77.2156svn/Demos/CcdPhysicsDemo/Makefile.am	2010-08-08 02:38:03.848450900 +0900
@@ -1,5 +1,5 @@
 noinst_PROGRAMS=CcdPhysicsDemo
 
 CcdPhysicsDemo_SOURCES=CcdPhysicsDemo.cpp CcdPhysicsDemo.h main.cpp
-CcdPhysicsDemo_CXXFLAGS=-I@top_builddir@/src -I@top_builddir@/Demos/OpenGL $(CXXFLAGS)
+CcdPhysicsDemo_CXXFLAGS=-I$(top_srcdir)/src -I$(top_srcdir)/Demos/OpenGL $(CXXFLAGS)
 CcdPhysicsDemo_LDADD=-L../OpenGL -lbulletopenglsupport -L../../src -lbulletdynamics -lbulletcollision -lbulletmath @opengl_LIBS@
--- origsrc/bullet-2.77.2156svn/Demos/MultiThreadedDemo/Makefile.am	2010-08-08 00:06:45.000000000 +0900
+++ src/bullet-2.77.2156svn/Demos/MultiThreadedDemo/Makefile.am	2010-08-08 02:38:25.254700900 +0900
@@ -1,5 +1,5 @@
 noinst_PROGRAMS=MultiThreadedDemo
 
 MultiThreadedDemo_SOURCES=MultiThreadedDemo.cpp MultiThreadedDemo.h main.cpp
-MultiThreadedDemo_CXXFLAGS=-I@top_builddir@/src -I@top_builddir@/Demos/OpenGL -I@top_builddir@/Extras  $(CXXFLAGS)
+MultiThreadedDemo_CXXFLAGS=-I$(top_srcdir)/src -I$(top_srcdir)/Demos/OpenGL -I$(top_srcdir)/Extras  $(CXXFLAGS)
 MultiThreadedDemo_LDADD=-L../OpenGL -L../../Extras  -L../../src  -lbulletmultithreaded -lbulletopenglsupport -lbulletdynamics -lbulletcollision -lbulletmath @opengl_LIBS@ -lpthread
--- origsrc/bullet-2.77.2156svn/Demos/OpenGL/Makefile.am	2010-08-08 00:06:24.000000000 +0900
+++ src/bullet-2.77.2156svn/Demos/OpenGL/Makefile.am	2010-08-08 02:23:49.114075900 +0900
@@ -9,4 +9,4 @@ libbulletopenglsupport_a_SOURCES	= \
 	 DebugCastResult.h  GLDebugDrawer.cpp   \
 	GL_ShapeDrawer.h    GlutStuff.cpp       RenderTexture.h
 
-INCLUDES=-I../../src
+INCLUDES=-I$(top_srcdir)/src
--- origsrc/bullet-2.77.2156svn/Demos/SoftDemo/Makefile.am	2010-08-08 00:06:39.000000000 +0900
+++ src/bullet-2.77.2156svn/Demos/SoftDemo/Makefile.am	2010-08-08 02:38:44.426575900 +0900
@@ -1,5 +1,5 @@
 noinst_PROGRAMS=SoftDemo
 
 SoftDemo_SOURCES=SoftDemo.cpp SoftDemo.h main.cpp
-SoftDemo_CXXFLAGS=-I@top_builddir@/src -I@top_builddir@/Demos/OpenGL $(CXXFLAGS)
+SoftDemo_CXXFLAGS=-I$(top_srcdir)/src -I$(top_srcdir)/Demos/OpenGL $(CXXFLAGS)
 SoftDemo_LDADD=-L../OpenGL -lbulletopenglsupport -L../../src -lbulletsoftbody -lbulletdynamics -lbulletcollision -lbulletmath @opengl_LIBS@
--- origsrc/bullet-2.77.2156svn/Demos/TerrainDemo/Makefile.am	2010-08-08 00:06:54.000000000 +0900
+++ src/bullet-2.77.2156svn/Demos/TerrainDemo/Makefile.am	2010-08-08 02:33:26.067200900 +0900
@@ -2,5 +2,5 @@
 noinst_PROGRAMS=TerrainDemo
 
 TerrainDemo_SOURCES=TerrainDemo.cpp TerrainDemo.h main.cpp
-TerrainDemo_CXXFLAGS=-I@top_builddir@/src -I@top_builddir@/Demos/OpenGL $(CXXFLAGS)
+TerrainDemo_CXXFLAGS=-I$(top_srcdir)/src -I$(top_srcdir)/Demos/OpenGL $(CXXFLAGS)
 TerrainDemo_LDADD=-L../OpenGL -lbulletopenglsupport -L../../src -lbulletdynamics -lbulletcollision -lbulletmath @opengl_LIBS@
--- origsrc/bullet-2.77.2156svn/Demos/VehicleDemo/Makefile.am	2010-08-08 00:06:41.000000000 +0900
+++ src/bullet-2.77.2156svn/Demos/VehicleDemo/Makefile.am	2010-08-08 02:37:26.817200900 +0900
@@ -1,5 +1,5 @@
 noinst_PROGRAMS=VehicleDemo
 
 VehicleDemo_SOURCES=VehicleDemo.cpp VehicleDemo.h main.cpp
-VehicleDemo_CXXFLAGS=-I@top_builddir@/src -I@top_builddir@/Demos/OpenGL $(CXXFLAGS)
+VehicleDemo_CXXFLAGS=-I$(top_srcdir)/src -I$(top_srcdir)/Demos/OpenGL $(CXXFLAGS)
 VehicleDemo_LDADD=-L../OpenGL -lbulletopenglsupport -L../../src -lbulletdynamics -lbulletcollision -lbulletmath @opengl_LIBS@
--- origsrc/bullet-2.77.2156svn/Extras/Makefile.am	2010-08-08 00:06:16.000000000 +0900
+++ src/bullet-2.77.2156svn/Extras/Makefile.am	2010-08-08 02:18:19.270325900 +0900
@@ -41,7 +41,7 @@ libglui_a_SOURCES =\
 		glui/arcball.h\
 		glui/algebra3.h
 
-libconvexdecomposition_a_CXXFLAGS = ${CXXFLAGS} -IConvexDecomposition/ -I../src
+libconvexdecomposition_a_CXXFLAGS = ${CXXFLAGS} -I$(top_srcdir)/Extras/ConvexDecomposition/ -I$(top_srcdir)/src
 libconvexdecomposition_a_SOURCES =\
 		ConvexDecomposition/concavity.cpp\
 		ConvexDecomposition/ConvexDecomposition.cpp\
@@ -73,6 +73,6 @@ libconvexdecomposition_a_SOURCES =\
 		ConvexDecomposition/bestfitobb.h\
 		ConvexDecomposition/meshvolume.h
 
-libgimpactutils_a_CXXFLAGS = ${CXXFLAGS}  -I../src -IGIMPACTUtils -IConvexDecomposition
+libgimpactutils_a_CXXFLAGS = ${CXXFLAGS}  -I$(top_srcdir)/src -I$(top_srcdir)/Extras/GIMPACTUtils -I$(top_srcdir)/Extras/ConvexDecomposition
 libgimpactutils_a_SOURCES = GIMPACTUtils/btGImpactConvexDecompositionShape.cpp GIMPACTUtils/btGImpactConvexDecompositionShape.h
 
--- origsrc/bullet-2.77.2156svn/bullet.pc.in	2010-08-08 00:07:13.000000000 +0900
+++ src/bullet-2.77.2156svn/bullet.pc.in	2010-08-08 12:51:57.810921300 +0900
@@ -7,5 +7,5 @@ Name: bullet
 Description: Bullet Continuous Collision Detection and Physics Library
 Requires:
 Version: @PACKAGE_VERSION@
-Libs: -L${libdir} -lBulletSoftBody -lBulletDynamics -lBulletCollision -lLinearMath
+Libs: -L${libdir} -lbulletmath -lbulletcollision -lbulletdynamics -lbulletsoftbody -lbulletmultithreaded
 Cflags: -I${includedir}/bullet
--- origsrc/bullet-2.77.2156svn/configure.ac	2010-08-08 00:07:13.000000000 +0900
+++ src/bullet-2.77.2156svn/configure.ac	2010-08-08 00:11:10.111281200 +0900
@@ -16,14 +16,19 @@ AC_CONFIG_SRCDIR([configure.ac])
 AM_INIT_AUTOMAKE
 AM_PROG_CC_C_O
 AC_PROG_CXX
-AC_PROG_LIBTOOL
+LT_INIT(win32-dll)
 
 case "$host" in
-        *-*-mingw*|*-*-cygwin*)
+        *-*-mingw*)
                 AC_DEFINE(PLATFORM_WIN32, 1, [Platform is Win32])
                 opengl_LIBS="-lunsupported_platform"
                 PLATFORM_STRING="Win32"
                 ;;
+        *-*-cygwin*)
+                AC_DEFINE(PLATFORM_CYGWIN, 1, [Platform is Cygwin])
+                opengl_LIBS="-lGL -lGLU -lglut"
+                PLATFORM_STRING="Cygwin"
+                ;;
         *-*-linux*)
                 AC_DEFINE(PLATFORM_LINUX, 1, [Platform is Linux])
                 opengl_LIBS="-lGL -lGLU -lglut"
--- origsrc/bullet-2.77.2156svn/src/Makefile.am	2010-08-08 00:03:11.000000000 +0900
+++ src/bullet-2.77.2156svn/src/Makefile.am	2010-08-08 13:56:42.935921300 +0900
@@ -6,11 +6,8 @@ nobase_bullet_include_HEADERS = \
 
 if CONDITIONAL_BUILD_MULTITHREADED
 nobase_bullet_include_HEADERS += \
+	BulletMultiThreaded/btParallelConstraintSolver.h \
 	BulletMultiThreaded/PosixThreadSupport.h \
-	BulletMultiThreaded/vectormath/scalar/cpp/mat_aos.h \
-	BulletMultiThreaded/vectormath/scalar/cpp/vec_aos.h \
-	BulletMultiThreaded/vectormath/scalar/cpp/quat_aos.h \
-	BulletMultiThreaded/vectormath/scalar/cpp/vectormath_aos.h \
 	BulletMultiThreaded/PpuAddressSpace.h \
 	BulletMultiThreaded/SpuCollisionTaskProcess.h \
 	BulletMultiThreaded/PlatformDefinitions.h \
@@ -41,6 +38,8 @@ lib_LTLIBRARIES	= libbulletmath.la libbu
 
 libbulletmultithreaded_la_CXXFLAGS = ${CXXFLAGS} -I./BulletMultiThreaded/vectormath/scalar/cpp
 libbulletmultithreaded_la_SOURCES =\
+		BulletMultiThreaded/btParallelConstraintSolver.cpp \
+		BulletMultiThreaded/btParallelConstraintSolver.h \
 		BulletMultiThreaded/SpuCollisionObjectWrapper.cpp \
 		BulletMultiThreaded/SpuSampleTask/SpuSampleTask.cpp \
 		BulletMultiThreaded/SpuLibspe2Support.cpp \
@@ -83,7 +82,8 @@ libbulletmultithreaded_la_SOURCES =\
 		BulletMultiThreaded/SpuNarrowPhaseCollisionTask/boxBoxDistance.cpp \
 		BulletMultiThreaded/SpuNarrowPhaseCollisionTask/boxBoxDistance.h \
 		BulletMultiThreaded/SpuNarrowPhaseCollisionTask/Box.h
-
+libbulletmultithreaded_la_LDFLAGS = -no-undefined
+libbulletmultithreaded_la_LIBADD = libbulletmath.la libbulletcollision.la libbulletsoftbody.la
 else
 lib_LTLIBRARIES	= libbulletmath.la libbulletcollision.la libbulletdynamics.la libbulletsoftbody.la
 endif
@@ -118,7 +118,7 @@ libbulletmath_la_SOURCES	= \
 		LinearMath/btDefaultMotionState.h \
 		LinearMath/btIDebugDraw.h \
 		LinearMath/btRandom.h
-
+libbulletmath_la_LDFLAGS = -no-undefined
 
 libbulletcollision_la_SOURCES = \
 		BulletCollision/NarrowPhaseCollision/btRaycastCallback.cpp \
@@ -299,6 +299,8 @@ libbulletcollision_la_SOURCES = \
                 BulletCollision/Gimpact/gim_contact.cpp\
                 BulletCollision/Gimpact/gim_memory.cpp\
                 BulletCollision/Gimpact/gim_tri_collision.cpp
+libbulletcollision_la_LDFLAGS = -no-undefined
+libbulletcollision_la_LIBADD = libbulletmath.la
 
 libbulletdynamics_la_SOURCES = \
 		BulletDynamics/Dynamics/btContinuousDynamicsWorld.cpp \
@@ -349,6 +351,8 @@ libbulletdynamics_la_SOURCES = \
 		BulletDynamics/Vehicle/btVehicleRaycaster.h \
 		BulletDynamics/Vehicle/btRaycastVehicle.h \
 		BulletDynamics/Vehicle/btWheelInfo.h
+libbulletdynamics_la_LDFLAGS = -no-undefined
+libbulletdynamics_la_LIBADD = libbulletmath.la libbulletcollision.la
 
 libbulletsoftbody_la_SOURCES = \
 		BulletSoftBody/btDefaultSoftBodySolver.cpp \
@@ -368,8 +372,8 @@ libbulletsoftbody_la_SOURCES = \
 		BulletSoftBody/btSoftBodyConcaveCollisionAlgorithm.h \
 		BulletSoftBody/btSoftRigidDynamicsWorld.h \
 		BulletSoftBody/btSoftBodyHelpers.h
-
-
+libbulletsoftbody_la_LDFLAGS = -no-undefined
+libbulletsoftbody_la_LIBADD = libbulletmath.la libbulletcollision.la libbulletdynamics.la
 
 nobase_bullet_include_HEADERS += \
 	BulletSoftBody/btSoftBodyRigidBodyCollisionConfiguration.h \
