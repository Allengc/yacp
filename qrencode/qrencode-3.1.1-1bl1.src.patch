--- origsrc/qrencode-3.1.1/Makefile.am	2010-01-20 05:13:25.000000000 +0900
+++ src/qrencode-3.1.1/Makefile.am	2010-12-05 16:00:12.233132900 +0900
@@ -16,7 +16,7 @@ libqrencode_la_SOURCES = qrencode.c qren
 						 split.c split.h \
 						 mask.c mask.h
 
-libqrencode_la_LDFLAGS = -version-number $(MAJOR_VERSION):$(MINOR_VERSION):$(MICRO_VERSION)
+libqrencode_la_LDFLAGS = -version-number $(MAJOR_VERSION):$(MINOR_VERSION):$(MICRO_VERSION) -no-undefined
 
 include_HEADERS = qrencode.h
 
--- origsrc/qrencode-3.1.1/configure.ac	2010-02-03 09:42:12.000000000 +0900
+++ src/qrencode-3.1.1/configure.ac	2010-12-05 16:00:00.045608100 +0900
@@ -18,7 +18,6 @@ AC_CANONICAL_TARGET
 
 AM_INIT_AUTOMAKE(qrencode, $VERSION)
 
-AC_DISABLE_STATIC
 AC_C_CONST
 AC_C_INLINE
 AC_HEADER_STDC
@@ -26,7 +25,7 @@ AC_HEADER_STDC
 AC_PROG_CC
 AM_PROG_CC_C_O
 AC_PROG_INSTALL
-AC_PROG_LIBTOOL
+LT_INIT(win32-dll)
 PKG_PROG_PKG_CONFIG
 
 AC_CONFIG_FILES([Makefile libqrencode.pc tests/Makefile qrencode.spec qrencode.1])
@@ -36,7 +35,7 @@ AC_ARG_WITH([tools], [AC_HELP_STRING([--
  [build_tools=$withval], [build_tools=yes])
 AM_CONDITIONAL(BUILD_TOOLS, [test "x$build_tools" = "xyes" ])
 if test x$build_tools = xyes ; then
-	PKG_CHECK_MODULES(png, "libpng12")
+	PKG_CHECK_MODULES(png, "libpng14")
 fi
 
 dnl --with-tests
--- origsrc/qrencode-3.1.1/tests/Makefile.am	2010-01-20 05:13:25.000000000 +0900
+++ src/qrencode-3.1.1/tests/Makefile.am	2010-12-05 16:00:45.951617700 +0900
@@ -2,7 +2,8 @@ if HAVE_SDL
 sdlPROGRAMS = view_qrcode
 endif
 
-noinst_PROGRAMS = test_qrinput test_bitstream test_estimatebit \
+TESTS = test_all.sh
+check_PROGRAMS = test_qrinput test_bitstream test_estimatebit \
 				  test_qrspec test_rs test_qrencode prof_qrencode \
 				  test_split test_monkey create_frame_pattern \
 				  $(sdlPROGRAMS)
