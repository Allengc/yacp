--- origsrc/libjit/configure.ac	2010-12-03 23:47:03.000000000 +0900
+++ src/libjit/configure.ac	2010-12-03 23:48:56.628757200 +0900
@@ -38,17 +38,7 @@ AC_MSG_CHECKING([if building for some Wi
 AC_SUBST(JIT_INT64_INCLUDE)
 case "$host" in
 	*-*-cygwin*)
-		platform_win32=yes
-		if test "x$CC" = "x" ; then
-			CC="gcc -mno-cygwin"
-		fi
-		if test "x$CXX" = "x" ; then
-			if test "x$CC" = "xcl" ; then
-				CXX="cl"
-			else
-				CXX="g++ -mno-cygwin"
-			fi
-		fi
+		platform_win32=no
 		suppress_libm=yes
 		JIT_INT64_INCLUDE='#include <stdlib.h>'
 		;;
@@ -108,8 +98,7 @@ AC_PROG_LN_S
 AC_PROG_MAKE_SET
 AC_PROG_YACC
 AM_PROG_LEX
-AC_LIBTOOL_WIN32_DLL
-AC_PROG_LIBTOOL
+LT_INIT(win32-dll)
 
 dnl Set the correct flags for compiling with MSVC.  "/QIfist" is needed
 dnl on systems with both VC 6.0 and VC 7.0 installed: sometimes VC 7.0
--- origsrc/libjit/jit/Makefile.am	2010-12-03 23:47:04.000000000 +0900
+++ src/libjit/jit/Makefile.am	2010-12-04 01:10:06.991388000 +0900
@@ -91,11 +91,11 @@ libjit_la_LDFLAGS = -version-info $(LIBJ
 
 jit-interp.lo: jit-interp-labels.h
 
-jit-interp-labels.h: $(top_srcdir)/include/jit/jit-opcode.h \
-		$(top_srcdir)/jit/jit-interp-opcode.h $(srcdir)/mklabel.sh
+jit-interp-labels.h: $(top_builddir)/include/jit/jit-opcode.h \
+		$(top_builddir)/jit/jit-interp-opcode.h $(srcdir)/mklabel.sh
 	$(SHELL) $(srcdir)/mklabel.sh "$(AWK)" \
-		$(top_srcdir)/include/jit/jit-opcode.h \
-		$(top_srcdir)/jit/jit-interp-opcode.h >jit-interp-labels.h
+		$(top_builddir)/include/jit/jit-opcode.h \
+		$(top_builddir)/jit/jit-interp-opcode.h >jit-interp-labels.h
 
 jit-rules-x86.lo: jit-rules-x86.inc
 
--- origsrc/libjit/jitdynamic/jit-dynlib.c	2010-12-03 23:47:04.000000000 +0900
+++ src/libjit/jitdynamic/jit-dynlib.c	2010-12-03 23:50:53.757179600 +0900
@@ -396,7 +396,11 @@ void *jit_dynlib_get_symbol(jit_dynlib_h
 
 const char *jit_dynlib_get_suffix(void)
 {
+#if defined(__CYGWIN__)
+	return "dll";
+#else
 	return "so";
+#endif
 }
 
 #else	/* No dynamic library support */
