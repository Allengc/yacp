--- origsrc/libmspack/Makefile.am	2010-07-25 15:14:08.000000000 +0900
+++ src/libmspack/Makefile.am	2010-07-25 15:14:59.609117300 +0900
@@ -38,7 +38,7 @@ libmspack_la_SOURCES =	mspack/mspack.h \
 			mspack/readbits.h mspack/readhuff.h \
 			mspack/lzss.h mspack/lzssd.c \
 			mspack/des.h mspack/sha.h
-libmspack_la_LDFLAGS =	-export-symbols-regex '^mspack_' -version-info 1:0:1
+libmspack_la_LDFLAGS =	-export-symbols-regex '^mspack_' -version-info 1:0:1 -no-undefined
 
 libmscabd_la_SOURCES =	mspack/mspack.h \
 			mspack/system.h mspack/system.c \
@@ -47,14 +47,14 @@ libmscabd_la_SOURCES =	mspack/mspack.h \
 			mspack/mszip.h mspack/mszipd.c \
 			mspack/qtm.h mspack/qtmd.c \
 			mspack/readbits.h mspack/readhuff.h
-libmscabd_la_LDFLAGS =	-export-symbols-regex '^mspack_'
+libmscabd_la_LDFLAGS =	-export-symbols-regex '^mspack_' -no-undefined
 
 libmschmd_la_SOURCES =	mspack/mspack.h \
 			mspack/system.h mspack/system.c \
 			mspack/chm.h mspack/chmd.c \
 			mspack/lzx.h mspack/lzxd.c \
 			mspack/readbits.h mspack/readhuff.h
-libmschmd_la_LDFLAGS =	-export-symbols-regex '^mspack_'
+libmschmd_la_LDFLAGS =	-export-symbols-regex '^mspack_' -no-undefined
 
 test_chmx_SOURCES =	test/chmx.c test/error.h libmschmd.la
 test_chmx_LDADD =	libmschmd.la
--- origsrc/libmspack/configure.ac	2010-07-25 15:14:08.000000000 +0900
+++ src/libmspack/configure.ac	2010-07-25 15:14:38.577867300 +0900
@@ -19,6 +19,7 @@ AM_CONDITIONAL(DEBUG, test x$enable_debu
 # Checks for programs.
 AC_PROG_CC
 AC_PROG_INSTALL
+AC_LIBTOOL_WIN32_DLL
 AC_PROG_LIBTOOL
 AC_EXEEXT
 
