--- origsrc/libdsk-1.3.0/configure.in	2008-06-02 04:33:24.000000000 +0900
+++ src/libdsk-1.3.0/configure.in	2010-10-17 11:05:02.352181400 +0900
@@ -36,7 +36,7 @@ AC_PROG_CC
 AC_PROG_INSTALL
 dnl Obsoleted by LIBTOOL AC_PROG_RANLIB
 AC_PROG_MAKE_SET
-AM_PROG_LIBTOOL
+LT_INIT(win32-dll)
 
 dnl GCC extra options
 dnl Disable DLL export functions, because gcc 2.95.2 crashes
@@ -50,7 +50,11 @@ AC_HEADER_STDC
 AC_CHECK_HEADERS(errno.h limits.h sys/ioctl.h stat.h sys/stat.h sys/types.h)
 AC_CHECK_HEADERS(unistd.h termios.h)
 AC_CHECK_HEADERS(dirent.h fcntl.h utime.h pwd.h time.h dir.h direct.h)
-AC_CHECK_HEADERS(linux/fd.h linux/fdreg.h windows.h winioctl.h shlobj.h)
+AC_CHECK_HEADERS(linux/fd.h linux/fdreg.h winioctl.h shlobj.h)
+case "$host_os" in
+	cygwin*) ;;
+	*) AC_CHECK_HEADERS(windows.h) ;;
+esac
 
 dnl Checks for functions
 AC_CHECK_FUNCS(strcmpi stricmp strcasecmp, break)
--- origsrc/libdsk-1.3.0/lib/Makefile.am	2008-06-03 03:48:43.000000000 +0900
+++ src/libdsk-1.3.0/lib/Makefile.am	2010-10-17 11:04:32.299202600 +0900
@@ -30,7 +30,7 @@ EXTRA_DIST=$(CLASSDPRE)/Drive.java \
 # If interfaces have been removed set the right-hand number to 0.
 # 
 #
-libdsk_la_LDFLAGS = -version-info 5:4:2
+libdsk_la_LDFLAGS = -version-info 5:4:2 -no-undefined
 libdsk_la_SOURCES = dskread.c  dskwrite.c dskcheck.c dskstat.c \
 		   dsklphys.c dskfmt.c   dskopen.c  dskpars.c \
 		   dskerror.c dskseek.c  dsksecid.c dskgeom.c \
