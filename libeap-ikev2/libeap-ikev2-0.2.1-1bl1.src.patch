--- origsrc/libeap-ikev2-0.2.1/configure.in	2006-09-16 08:26:08.000000000 +0900
+++ src/libeap-ikev2-0.2.1/configure.in	2010-12-30 23:38:32.811518300 +0900
@@ -1,9 +1,7 @@
 AC_INIT(Makefile.in)
 AM_CONFIG_HEADER(src/config.h)
 AM_INIT_AUTOMAKE(libeap-ikev2,0.2.1)
-AM_MAINTAINER_MODE
-AC_PROG_LIBTOOL
-
+LT_INIT(win32-dll)
 
 AC_LANG_C
 dnl Checks for programs.
@@ -28,9 +26,12 @@ dnl Checks for header files.
 AC_HEADER_STDC
 
 AC_CHECK_HEADERS(netinet/in.h)
-AC_CHECK_HEADERS(winsock.h)
 AC_CHECK_HEADERS(stdint.h)
 AC_CHECK_HEADERS(pthread.h)
+case "$host_os" in
+  cygwin*) ;;
+  *) AC_CHECK_HEADERS(winsock.h) ;;
+esac
 
 dnl #
 dnl # extra argument: --openssl-includes=dir
@@ -57,7 +58,7 @@ AC_ARG_WITH(openssl-libraries,
 )
 
 old_LIBS=$LIBS
-LIBS=-lssl
+LIBS="-lssl -lcrypto"
 if test  "x$OPENSSL_LIBS" != "x"; then
     LIBS="$OPENSSL_LIBS $LIBS"
 fi    
--- origsrc/libeap-ikev2-0.2.1/src/Makefile.am	2006-09-16 08:26:08.000000000 +0900
+++ src/libeap-ikev2-0.2.1/src/Makefile.am	2010-12-30 23:52:41.271543900 +0900
@@ -44,6 +44,7 @@ libeap_ikev2_la_SOURCES= auth.c \
 			 utils.c \
 			 tiger.c
 
-
+libeap_ikev2_la_LDFLAGS = -no-undefined
+libeap_ikev2_la_LIBADD = -lssl -lcrypto
 
 MAINTAINERCLEANFILES=Makefile.in
